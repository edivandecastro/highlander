  <%= hidden_field_tag :create, charts_path %>
  <%= hidden_field_tag :route_update_search_service, update_search_service_charts_path %>
  <%= hidden_field_tag :route_update_schedule_service, update_schedule_service_charts_path %>
  <%= form_for @chart, url: '#' do |f| %>

    <div id="app">
      <div class="card">
        <div class="card-header">
          <h2>Configuração do Gráfico de Barra Simples
            <small>Informe dados referentes a exibição do gráfico</small>
          </h2>
          </div>
        <div class="card-body card-padding">
          <div class="row">
            <div class="col-sm-4">
              <div class="form-group">
                <div class="fg-line">
                  <%= f.text_field :title, class: "form-control", "v-model" => "graphic.title",  placeholder: "Título do Gráfico" %>
                </div>
              </div>
            </div>

            <div class="col-sm-4">
              <div class="form-group">
                <div class="fg-line">
                  <%= f.text_field :subtitle, class: "form-control", "v-model" => "graphic.subtitle",  placeholder: "Subtítulo do Gráfico" %>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <div class="form-group">
                <div class="fg-line">
                  <%= f.text_field :scale, class: "form-control", "v-model" => "graphic.titleScale",  placeholder: "Título da escala" %>
                </div>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="form-group">
                <div class="fg-line">
                  <%= f.text_field :min_value, class: "form-control", "v-model" => "graphic.valueScale", placeholder: "Valor Mínimo da escala" %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h2>Serviço de Pesquisa
            <small>Informe a fonte de pesquisa dos dados do gráfico</small>
          </h2>
        </div>

        <div class="card-body card-padding">
          <div class="row">
            <div class="col-sm-3 m-b-25">
              <select class="selectpicker" v-model="service.method">
                <option v-for="method in httpMethods" :value="method">{{ method }}</option>
              </select>
            </div>

            <div class="col-sm-3 m-b-25">
              <div class="form-group">
                <div class="fg-line">
                  <input type="text" v-model="service.url" name="url" class="form-control" placeholder="Informe a URL de requisição">
                </div>
              </div>
            </div>

            <div class="col-sm-3 m-b-25">
              <button @click="addQueryParams" class="btn btn-success waves-effect" type="button" data-toggle="tooltip"
                data-placement="right" title="" data-original-title="Adiciona parametros para a URL">
                <i class="zmdi zmdi-plus"></i>
              </button>
            </div>
          </div>

          <query-params v-for="(param, index) in queryParams" :query="param" :index="index" :key="index" ></query-params>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h2>Agendamento do Serviço de Pesquisa
            <small>Informe o momento para ativar o serviço de pesquisa dos dados do gráfico</small>
          </h2>
        </div>

        <div class="card-body card-padding">
          <div class="row">
            <div class="col-sm-3 m-b-25">
              <select class="selectpicker" v-model="schedule.type">
                <option v-for="typeRun in typeRunServices" :value="typeRun.code">{{ typeRun.description }}</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div v-if="schedule.type === 'in'">
               <schedule-in></schedule-in>
            </div>
            <div v-else-if="schedule.type === 'every'">
              <schedule-every></schedule-every>
            </div>
            <div v-else-if="schedule.type === 'at'">
              <schedule-at></schedule-at>
            </div>


          </div>

          <div class="row">
            <div class="col-sm-3">
              <button id="button-save-chart" class="btn btn-success waves-effect">Salvar</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <%= f.fields_for :service do |s| %>
      <%= hidden_field_tag :id, nil, class: "chart_id" %>

      <%= s.fields_for :schedule do |k| %>
        <div class="card">
          <div class="card-header">
            <h2>Agendamento do Serviço de Pesquisa
              <small>Informe o momento para ativar o serviço de pesquisa dos dados do gráfico</small>
            </h2>
          </div>

          <div class="card-body card-padding">
            <div class="row">
              <div class="col-sm-3 m-b-25">
                <%= k.select :type_run_service, options_type_run_service(@type_run_services), {}, { class: "selectpicker" } %>
              </div>
            </div>

            <div class="row">
              <div id="place-value-schedule"></div>
              <script id="in-template" type="text/x-handlebars-template">
                <div class="col-sm-3 m-b-25">
                  <div class="input-group form-group">
                    <span class="input-group-addon"><i class="zmdi zmdi-calendar"></i></span>
                    <%= k.text_field :date, class: "form-control input-mask", "data-mask" => "{{ value }}", placeholder: "{{ example }}" %>
                  </div>
                </div>
              </script>
            </div>

            <div class="row">
              <div class="col-sm-3">
                <button id="button-save-chart" class="btn btn-success waves-effect">Salvar</button>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    <% end %>
  <% end %>

<script id="fields-params-vue" type="text/x-template">
  <div class="row" identify="row-param">
    <div class="col-sm-3 m-b-25">
      <div class="form-group">
        <div class="fg-line">
          <input type="text" class="form-control" placeholder="Chave" :value="query.key" />
        </div>
      </div>
    </div>

    <div class="col-sm-3 m-b-25">
      <div class="form-group">
        <div class="fg-line">
          <input type="text" class="form-control" placeholder="Valor" :value="query.value" />
        </div>
      </div>
    </div>

    <div class="col-sm-3 m-b-25">
      <button @click="removeQueryParams(index)" class="btn btn-danger waves-effect" type="button">
        <i class="zmdi zmdi-minus"></i>
      </button>
    </div>
  </div>
</script>

<script id="in-template-vue" type="text/x-template">
  <div class="col-sm-3 m-b-25">
    <div class="input-group form-group">
      <span class="input-group-addon"><i class="zmdi zmdi-calendar"></i></span>
    </div>
  </div>
</script>

<script id="every-template-vue" type="text/x-template">
  <div class="col-sm-3 m-b-25">
    <div class="row">
      <div class="col-sm-6 m-b-25">
        <div class="form-group">
          <div class="fg-line">
            <input type="text" class="form-control" placeholder="Quantidade">
          </div>
        </div>
      </div>

      <div class="col-sm-6 m-b-25">
        <select class="selectpicker">
          <option value="s">SEGUNDOS(S)</option>
          <option value="m">MINUTO(S)</option>
          <option value="h">HORA(S)</option>
        </select>
      </div>
    </div>
  </div>
</script>

<script id="at-template-vue" type="text/x-template">
  <div class="col-sm-3 m-b-25">
    <div class="input-group form-group">
      <span class="input-group-addon"><i class="zmdi zmdi-calendar"></i></span>
      <input type="text" class="form-control input-mask" placeholder="{{ example_date }}" data-mask="{{ value_date }}">
    </div>
  </div>
  <div class="col-sm-3 m-b-25">
    <div class="input-group form-group">
      <input type="text" class="form-control input-mask" placeholder="{{ example_time }}" data-mask="{{ value_time }}">
    </div>
  </div>
</script>

<%= javascript_include_tag 'vue/charts.js' %>
